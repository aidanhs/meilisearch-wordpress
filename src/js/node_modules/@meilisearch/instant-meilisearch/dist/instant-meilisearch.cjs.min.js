"use strict";var e,t=(e=require("meilisearch"))&&"object"==typeof e&&"default"in e?e.default:e;function i(e){return Object.keys(e).reduce((t,i)=>(void 0!==e[i]&&(t[i]=e[i]),t),{})}module.exports=function(e,s,r={}){return{client:new t({host:e,apiKey:s}),hitsPerPage:r.hitsPerPage||10,limitPerRequest:r.limitPerRequest||50,attributesToHighlight:"*",transformToMeiliSearchParams:function(e){return i({q:e.query,facetsDistribution:e.facets.length?e.facets:void 0,facetFilters:e.facetFilters,attributesToHighlight:this.attributesToHighlight,limit:this.limitPerRequest})},replaceHighlightTags:function(e,t,i){return Object.keys(e).reduce((s,r)=>{let a=e[r];var n;return("string"==typeof(n=e[r])||n instanceof String)&&(a=e[r].replaceAll("<em>",t).replaceAll("</em>",i)),s[r]={value:a.toString()},s},{})},parseHits:function(e,t){if(void 0!==t.page){const i=this.hitsPerPage,s=t.page*i;e=e.splice(s,this.hitsPerPage)}return e.map(e=>{const i=e._formatted;return delete e._formatted,{...e,_highlightResult:this.replaceHighlightTags(i,t.highlightPreTag,t.highlightPostTag)}})},paginationParams:function(e,t){if(void 0!==t.page){const i=e%this.hitsPerPage==0?0:1;return{nbPages:Math.floor(e/this.hitsPerPage)+i,page:t.page}}},parseMeiliSearchResponse:function(e,t,s){this.hitsPerPage=s.hitsPerPage||this.hitsPerPage;const{exhaustiveFacetsCount:r,exhaustiveNbHits:a,facetsDistribution:n,nbHits:h,processingTimeMs:g,query:o,hits:c}=t;return{results:[i({index:e,hitsPerPage:this.hitsPerPage,facets:n,exhaustiveFacetsCount:r,exhaustiveNbHits:a,nbHits:h,processingTimeMs:g,query:o,...this.paginationParams(c.length,s),hits:this.parseHits(c,s)})]}},search:async function(e){const t=this.transformToMeiliSearchParams(e[0].params),i=e[0].indexName,s=await this.client.getIndex(i).search(t.q,t);return this.parseMeiliSearchResponse(i,s,e[0].params)}}};
//# sourceMappingURL=instant-meilisearch.cjs.min.js.map
